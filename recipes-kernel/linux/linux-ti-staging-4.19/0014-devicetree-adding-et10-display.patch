From 10e0f6f0ba3006cecae049e6ea7a0de5b39d84bb Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Stephan=20D=C3=BCnner?= <stephan.duenner@bytesatwork.ch>
Date: Thu, 26 Jan 2017 16:02:48 +0100
Subject: [PATCH] devicetree: adding et10 display

---
 arch/arm/boot/dts/bytepanel-et10.dts | 133 +++++++++++++++++++++++++++++++++++
 arch/arm/boot/dts/bytepanel.dtsi     |   2 +-
 2 files changed, 134 insertions(+), 1 deletion(-)
 create mode 100644 arch/arm/boot/dts/bytepanel-et10.dts

diff --git a/arch/arm/boot/dts/bytepanel-et10.dts b/arch/arm/boot/dts/bytepanel-et10.dts
new file mode 100644
index 000000000000..cae6568a3a4a
--- /dev/null
+++ b/arch/arm/boot/dts/bytepanel-et10.dts
@@ -0,0 +1,133 @@
+/*
+ * Copyright (C) 2015 Bytes at Work - http://www.bytesatwork.ch
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+/dts-v1/;
+
+#include "bytepanel.dtsi"
+
+/ {
+	model = "bytePanel ETML101000DH";
+	compatible = "batw,bytepanel-etml101000dh", "batw,bytepanel", "batw,m2", "ti,am33xx";
+
+	panel {
+		compatible = "ti,tilcdc,panel";
+		pinctrl-names = "default";
+		pinctrl-0 = <&lcd_pins_s0 &display_pins>;
+		enable-gpios = <&gpio1 25 GPIO_ACTIVE_LOW
+				 &gpio1 26 GPIO_ACTIVE_HIGH>;
+		status = "okay";
+		panel-info {
+			ac-bias		= <255>;
+			ac-bias-intrpt	= <0>;
+			dma-burst-sz	= <16>;
+			bpp		= <32>;
+			fdd		= <0x80>;
+			sync-edge	= <0>;
+			sync-ctrl	= <1>;
+			raster-order	= <0>;
+			fifo-th		= <0>;
+		};
+		display-timings {
+			native-mode = <&timing0>;
+
+			/* Settings for ETML0820A0DHA */
+			timing0: 1024x600 {
+				hactive		= <1024>;
+				vactive		= <600>;
+				hback-porch	= <155>;
+				hfront-porch	= <155>;
+				hsync-len	= <10>;
+				vback-porch	= <15>;
+				vfront-porch	= <15>;
+				vsync-len	= <5>;
+				clock-frequency = <51200000>;
+				hsync-active	= <0>;
+				vsync-active	= <0>;
+				pixelclk-active = <1>;
+			};
+		};
+	};
+};
+
+&am33xx_pinmux {
+	// ---- Display ----
+	lcd_pins_s0: lcd_pins_s0 {
+		pinctrl-single,pins = <
+			PIN_LCD_DATA0		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA1		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA2		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA3		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA4		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA5		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA6		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA7		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA8		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA9		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA10		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA11		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA12		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA13		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA14		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_DATA15		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_GPMC_AD8		(MUX_MODE1 | PIN_OUTPUT)	// lcd_data16
+			PIN_GPMC_AD9		(MUX_MODE1 | PIN_OUTPUT)	// lcd_data17
+			PIN_GPMC_AD10		(MUX_MODE1 | PIN_OUTPUT)	// lcd_data18
+			PIN_GPMC_AD11		(MUX_MODE1 | PIN_OUTPUT)	// lcd_data19
+			PIN_GPMC_AD12		(MUX_MODE1 | PIN_OUTPUT)	// lcd_data20
+			PIN_GPMC_AD13		(MUX_MODE1 | PIN_OUTPUT)	// lcd_data21
+			PIN_GPMC_AD14		(MUX_MODE1 | PIN_OUTPUT)	// lcd_data22
+			PIN_GPMC_AD15		(MUX_MODE1 | PIN_OUTPUT)	// lcd_data23
+			PIN_LCD_VSYNC		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_HSYNC		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_PCLK		(MUX_MODE0 | PIN_OUTPUT)
+			PIN_LCD_AC_BIAS_EN	(MUX_MODE0 | PIN_OUTPUT)
+		>;
+	};
+
+	// ---- Touch ----
+	touch_pins: pinmux_touch_pins {
+		pinctrl-single,pins = <
+			PIN_GPMC_A7		(MUX_MODE7 | PIN_INPUT_PULLUP)	// gpio1_23 /wake
+			PIN_GPMC_A8		(MUX_MODE7 | PIN_INPUT_PULLUP)	// gpio1_24 /int
+		>;
+	};
+};
+
+// ---- Display ----
+&lcdc {
+	pinctrl-names = "default";
+	pinctrl-0 = <&display_pins>;
+	status = "okay";
+	blue-and-red-wiring = "crossed";
+};
+
+// ---- Backlight ----
+&backlight {
+	status = "okay";
+};
+
+&epwmss0 {
+	status = "okay";
+};
+
+&ecap0 {
+	status = "okay";
+};
+
+// ---- Touch ----
+&i2c1 {
+	touch: edt-ft5306@38 {
+		pinctrl-names = "default";
+		pinctrl-0 = <&touch_pins>;
+
+		compatible = "edt,edt-ft5306";
+		reg = <0x38>;
+		interrupt-parent = <&gpio1>;
+		interrupts = <24 0>;
+		wake-gpios = <&gpio1 23 1>;
+	};
+};
diff --git a/arch/arm/boot/dts/bytepanel.dtsi b/arch/arm/boot/dts/bytepanel.dtsi
index 9a40cb58d4e9..e80ec4c8e9de 100644
--- a/arch/arm/boot/dts/bytepanel.dtsi
+++ b/arch/arm/boot/dts/bytepanel.dtsi
@@ -25,7 +25,7 @@
 	// FIXME: set pins not as LED; use a muxer or so
 	dispconf {
 		compatible = "gpio-leds";
-		status = "okay";
+		status = "disabled";
 		pinctrl-names = "default";
 		pinctrl-0 = <&display_pins>;
 
-- 
2.11.0

